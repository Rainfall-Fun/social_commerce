<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cqjtu.sc.goodsrecommendservice.db.dao.GoodsMapper">
  <select id="queryBySale" resultType="int" parameterType="map">
        select t1.goods_id
        from all_goods_info t1,all_order_detail t2
        where t1.goods_id=t2.goods_id
        group by t1.goods_id
        order by sum(t2.quantity) desc
        limit 0,#{limit,jdbcType=INTEGER};
    </select>
    <select id="queryByRegion" resultType="int" parameterType="map">
        select t3.goods_id
        from all_user_info t1,all_order t2,all_order_detail t3
        where t1.user_info_id=t2.user_info_id1 and t2.order_id=t3.order_id and t1.region_id=(select region_id from all_user_info where user_info_id=#{userId,jdbcType=INTEGER}) and t1.user_info_id!=#{userId,jdbcType=INTEGER}
        group by goods_id
        order by sum(t3.quantity) desc
        limit 0,#{limit,jdbcType=INTEGER};
    </select>
</mapper>
